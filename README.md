### 프로젝트 개요
- 목표:
    - 한국어 택스트를 입력하면 3D 아바타가 수어로 표현해주는 서비스 개발
- 역할:
    - EDA
    - Bart 모델 실험 및 파인튜닝
    - 블렌더 애니메이션 생성
- 환경: Local(windows, CUDA, Vram 8gb)

![image](https://github.com/user-attachments/assets/4245db0e-575b-4122-acaa-b68f81fc6df4)


### 프로젝트 배경

취업 준비를 하며 사이드 프로젝트로 AI 허브의 수어 데이터를 바탕으로 한국어 - 수어 번역모델을 개발해보았습니다. 사용자가 한국어 텍스트를 입력하면 이를 수어 형태소로 변환하여 출력하는 Bart 모델과 수어 형태소를 바탕으로 데이터셋의 좌표 데이터를 이용해 수어를 하는 아바타를 생성하는 모델, 크게 2가지로 구성된 프로젝트입니다.

### 프로젝트 수행 과정

### 1. EDA

데이터셋은 json 파일로 구성되어 있으며, 하나의 파일안에 한국어 문장, 수어 형태소, 프레임 별 좌표데이터로 구성되어 있습니다. 모든 파일에서 {한국어 문장: 수어 형태소 리스트} 형태로 데이터를 추출하였습니다.

```python
# json 파일 구조
1.json
├── metadata (객체): 영상 및 관련 인물에 대한 메타데이터
│   ├── id (문자열): 파일 식별자
│   ├── editor (객체): 편집자 정보
│   │   ├── id (숫자)
│   │   ├── age (숫자): 연령대 구분 (예: 3은 30대)
│   │   ├── sex (숫자): 성별 (예: 1은 남성)
│   │   ├── deaf (숫자): 농인 여부 (예: 1은 농인)
│   │   ├── residence (숫자): 거주지 구분
│   │   ├── school_id (숫자): 출신 학교 구분
│   │   ├── occupation_id (숫자): 직업 구분
│   │   ├── sign_start_age (숫자): 수어 시작 연령 구분
│   │   ├── main_communication (숫자): 주 사용 언어 구분 (예: 1은 수어)
│   │   ├── school_supplemental (문자열): 추가 학교 정보
│   │   ├── deaf_social_frequency (숫자): 농사회 교류 빈도
│   │   └── translation_experience_category (숫자): 번역 경험 범주
│   ├── signer (객체): 수어 화자 정보 (editor와 유사한 구조)
│   ├── augment (불리언): 데이터 증강 여부
│   ├── annotator (객체): 주석 작업자 정보 (editor와 유사한 구조, 일부 키 이름 다름: Deaf, translation_experience)
│   ├── video_fps (숫자): 비디오 프레임 속도
│   ├── translator (객체): 번역가 정보 (signer와 동일한 구조)
│   ├── video_date (문자열): 비디오 촬영 날짜 (YYYY-MM-DD)
│   ├── hand_default (문자열): 주로 사용하는 손 (예: "right")
│   ├── content_mismatch (객체): 내용 불일치 정보
│   │   └── month_added (배열): 불일치가 추가된 월 (이 경우 비어 있음)
│   └── filmed_in_studio (불리언): 스튜디오 촬영 여부
├── landmarks (객체): 영상에서 추출된 랜드마크 데이터
│   ├── camera_parameter (객체): 카메라 파라미터
│   │   ├── Rotation (배열): 회전 행렬 (숫자 배열)
│   │   ├── Translation (배열): 이동 벡터 (숫자 배열)
│   │   ├── intrinsic_F (배열): 전면 카메라 고유 파라미터 (숫자 배열)
│   │   ├── intrinsic_L (배열): 측면 카메라 고유 파라미터 (숫자 배열)
│   │   ├── Fprojectionmatrix (배열): 전면 카메라 투영 행렬 (숫자 배열의 배열)
│   │   └── Lprojectionmatrix (배열): 측면 카메라 투영 행렬 (숫자 배열의 배열)
│   ├── face_keypoints_3d (배열): 얼굴 키포인트 3D 좌표 (숫자 배열의 배열, 일부 생략됨)
│   ├── pose_keypoints_3d (배열): 자세 키포인트 3D 좌표 (숫자 배열의 배열, 일부 생략됨)
│   ├── hand_left_keypoints_3d (배열): 왼손 키포인트 3D 좌표 (숫자 배열의 배열, 일부 생략됨)
│   └── hand_right_keypoints_3d (배열): 오른손 키포인트 3D 좌표 (숫자 배열의 배열, 일부 생략됨)
├── nms_script (객체): 비수동 신호(Non-Manual Signals) 스크립트
│   ├── Ci (배열): 입모양(Mouthing) 관련 정보 배열
│   │   └── (객체 배열): 각 객체는 start, end, descriptor 포함
│   ├── Hs (배열): 머리 움직임 관련 정보 배열 (이 경우 비어 있음)
│   ├── EBf (배열): 눈썹 움직임 관련 정보 배열
│   │   └── (객체 배열): 각 객체는 start, end, descriptor 포함
│   ├── Hno (배열): 머리 끄덕임 관련 정보 배열 (이 경우 비어 있음)
│   ├── Mmo (배열): 입 움직임 관련 정보 배열
│   │   └── (객체 배열): 각 객체는 start, end, descriptor 포함
│   ├── Mo1 (배열): 기타 입 움직임 관련 정보 배열 (이 경우 비어 있음)
│   ├── Tbt (배열): 몸통 기울임 관련 정보 배열 (이 경우 비어 있음)
│   └── Mctr (배열): 입술 중앙 추적 관련 정보 배열
│       └── (객체 배열): 각 객체는 start, end, descriptor 포함
├── korean_text (문자열): 한국어 원문 텍스트
├── sign_script (객체): 수어 스크립트 정보
│   ├── sign_gestures_both (배열): 양손 또는 주사용 손 사용 수어 동작 정보 배열
│   │   └── (객체 배열): 각 객체는 동작의 시작/끝 시간, 표현 방식, 수어 단어 ID, 손 위치/방향, 문장 내 위치 정보 포함
│   ├── sign_gestures_weak (배열): 보조 손 사용 수어 동작 정보 배열 (이 경우 비어 있음)
│   └── sign_gestures_strong (배열): 강조 손 사용 수어 동작 정보 배열
│       └── (객체 배열): 각 객체는 동작의 시작/끝 시간, 표현 방식, 수어 단어 ID, 손 위치/방향 정보 포함
└── simplication (불리언): 단순화 여부

# 추출 데이터 샘플
{금일 21시부로 한파에 따른 수도관 동파예방을 위하여 계량기 보온조치 바랍니다.:오늘1 밤1 시:9시 춥다1 막대기4 계량기2 따뜻하다1 수도꼭지1 물1 얼다1 막다1 검사1}
{밤새 강설과 한파로 인해 도로가 미끄러우니 안전운행 하시기 바랍니다:밤새다0 눈내리다2# 춥다1 온도내려가다1 길1 운전1 조심1 자동차2#}
...
```

해당 데이터셋의 경우 재난상황과 관련된 한국어 텍스트 데이터셋만 있었기 때문에, 형태소만을 따로 추출하고 해당 형태소들로 llm으로 증강하여 일상대화 데이터를 추가하였습니다.

```python
# LLM 증강 데이터 샘플
여기, 길, 복잡, 지도, 필수, 헤매다.|여기는 길이 복잡해서 지도가 필수예요. 안 그러면 헤매요.
오늘, 날씨, 덥다, 시원하다, 물, 마시다.|오늘 날씨가 너무 더워서 시원한 물을 마셔야겠어요.
여기, 와이파이, 안되다, 불편, 스마트폰, 사용, 어렵다.|여기 와이파이가 안 돼서 불편하고 스마트폰 사용이 어렵네요.
병원, 예약, 늦다, 변경, 하다, 전화.|병원 예약 시간에 늦어서 변경하려고 전화했어요.
```

다만 LLM으로 생성된 데이터들이 비슷한 경우가 많고 다양한 상황에 대한 문장생성을 위해서는 “한국어 일상대화 데이터셋”을 입력으로 하고 이를 수어 형태소로 변경하는 방식으로 일상대화 수어 데이터를 제작해도 좋을 것 같습니다.

본 프로젝트에서는 컴퓨터 용량의 한계로 한국어 일상대화 데이터셋은 사용하지 못했습니다.

### 1. 한국어 → 수어 형태소 번역모델

EDA를 통해 정제된 한국어 텍스트: 수어 형태소 데이터를 이용해 koBart 모델 학습을 진행했습니다. 크게 복잡하지 않은 한국어 → 한글수어 번역 테스크이기 때문에 sLLM을 사용하지 않고 Bart, GPT 모델 등으로 충분히 처리가 가능하다고 판단하여 koBart 모델로 진행하였습니다.

모델학습은 Wandb를 이용해 모니터링 하였고 총 2가지 허깅페이스 오픈소스 koBart 모델을 선정하여 학습을 진행하였습니다. 모델은 koBart base 모델로 선정하였고 이유는 타 summary 모델, 혹은 translation 모델의 경우 이미 다른 테스크로 학습이 진행되었고, 이에따라 수어의 형태를 정확히 반영하기 어렵기도 하고 이미 학습데이터가 약 13만개로 충분하다고 판단되어 base 모델 중 선정하였습니다.

1. gogamza/kobart-base-v2

![image](https://github.com/user-attachments/assets/d196c3da-a9a5-44be-8c22-b91d90c09d2e)


실수로 학습 간 wandb.finish()를 설정하지 않아 하나의 학습으로 나오게 되었습니다.

loss score의 경우 0.699… 점으로 안정적이였지만 출력에서 루프현상이 발생하여 생성물이 불안정하였습니다. 이후 파라미터를 수정했음에도 불구하고 루프 현상이 지속적으로 발생하였습니다.

```python
# 생성 결과
한국어: 내일 오후 미새먼지 주의보가 발령되었으니 외부활동을 삼가해 주시기 바랍니다.

생성물: 먼지1# 주의보1 밖1 행동1 하지마1 내일1 오후1 미치다0# 북쪽3#  왜1 내일1 오후1 
올것이다2 확인1 전화걸다1 하지마1 조심1 신경쓰다1 부탁1 왜1 내일1 미치다0# 올것이다2 
느끼다1 위험1 북쪽3#  지시1# 검사1 저녁1 기억1 확인1 검사1 확인1 검사1 확인1 전화걸다1 
저녁1 올것이다2 올것이다2 기억1 올것이다2 아마1 기억1 기억1 검사1 확인1 검사
```

1. hyunwoongko/kobart

해당 모델의 경우 기본 파라미터로 학습한 결과물도 1번 모델 대비 안정적으로 출력이 되는것을 확인했습니다.

이후 다양한 파라미터를 실험하여 loss 값을조금이라도 더 안정화 하였습니다.

![image](https://github.com/user-attachments/assets/0bb6a544-848a-4490-9ad7-59757dd9f8a9)


위 실험결과를 보면 약 4 에포크 전후에서 Validation score가 안정화되고 이후에는 과적합이 일어나는 것을 볼 수 있습니다. 따라서 에포크는 5로 고정하고 Validation Loss값이 최소치인 모델을 저장하도록 코드를 설정한 뒤 이후 실험을 진행하였습니다.

![image](https://github.com/user-attachments/assets/5703389e-6588-4eb8-83c0-a8a564a1b08f)


Validation loss의 최소값을 나타낸 파라미터는 다음과 같습니다.

```python
Config: {'learning_rate': 0.0001, 'epochs': 5, 'batch_size': 8, 
'max_source_length': 128, 'max_target_length': 128, 
'scheduler_warmup_steps': 10000, 'dropout': 0.1, 'num_beams': 5}
```

예상과 다르게 ‘max_source_length’, 'max_target_length'의 값을 늘려도 Validation의 값은 오히려 떨어지는 것을 확인했습니다. 아마 학습데이터 상에서 해당 길이를 초과하는 데이터가 적었고 길이가 긴 몇몇 데이터가 노이즈로 작용했다고 추측됩니다.

'num_beams'의 경우 줄이거나 늘리는 실험도 진행해 보았지만, 5가 최적값임을 확인했습니다.

### 실험 파라미터

```python
experiment_configs = [
    {
        "learning_rate": 5e-5,
        "epochs": 5,
        "batch_size": 8,
        "max_source_length": 128,
        "max_target_length": 128,
        "scheduler_warmup_steps": 5000,
        "dropout": 0.1,
        "num_beams": 5
    },
    {
        "learning_rate": 5e-5,
        "epochs": 5,
        "batch_size": 8,
        "max_source_length": 128,
        "max_target_length": 128,
        "scheduler_warmup_steps": 5000,
        "dropout": 0.2,
        "num_beams": 5
    },
    {
        "learning_rate": 5e-5,
        "epochs": 5,
        "batch_size": 8,
        "max_source_length": 128,
        "max_target_length": 128,
        "scheduler_warmup_steps": 5000,
        "dropout": 0.1,
        "num_beams": 8
    },
    {
        "learning_rate": 5e-5,
        "epochs": 5,
        "batch_size": 8,
        "max_source_length": 256,
        "max_target_length": 256,
        "scheduler_warmup_steps": 5000,
        "dropout": 0.1,
        "num_beams": 5
    },
    {
        "learning_rate": 1e-4,
        "epochs": 5,
        "batch_size": 8,
        "max_source_length": 128,
        "max_target_length": 128,
        "scheduler_warmup_steps": 5000,
        "dropout": 0.1,
        "num_beams": 5
    },
    {
        "learning_rate": 1e-4,
        "epochs": 5,
        "batch_size": 8,
        "max_source_length": 256,
        "max_target_length": 256,
        "scheduler_warmup_steps": 10000,
        "dropout": 0.1,
        "num_beams": 5
    },
    {
        "learning_rate": 1e-4,
        "epochs": 10,
        "batch_size": 8,
        "max_source_length": 256,
        "max_target_length": 256,
        "scheduler_warmup_steps": 10000,
        "dropout": 0.1,
        "num_beams": 5
    },
    {
        "learning_rate": 1e-4,
        "epochs": 10,
        "batch_size": 8,
        "max_source_length": 256,
        "max_target_length": 256,
        "scheduler_warmup_steps": 10000,
        "dropout": 0.2,
        "num_beams": 5
    },
]
```

```python
# 생성 결과
한국어: 내일 오후 미새먼지 주의보가 발령되었으니 외부활동을 삼가해 주시기 바랍니다.

생성물: 먼지1# 주의보1 밖1 하지마1 내일1 오후1

한국어: 경북지역 산불발생 대피하세요.

생성물: 경북1 지역1 산불1 사고1 도망1 부탁1
```

이후 추론과정에서 데이터셋 내부에 있는 형태소 토큰만 출력 가능하도록 제한하여 추론되도록 하였습니다.

이때, 수어 형태소가 한글+숫자의 형태로 되어있어 기존 토크나이저의 하나의 토큰에 맵핑되지 않는다는 것을 확인 하였습니다. 별도의 Vocabulary를 추가하여 토크나이저를 재학습시키기 보다, 한글 수어 형태소의 경우 이미 토크나이저에 있는 Vocabulary의 의미를 담고 있기 때문에 단순히 수어 형태소 리스트에 있는 형태소 1개의 토큰 순서대로 출력이 가능하도록 제한조건을 구성하였습니다.

```python
def extract_morph_tokens(dataset):
    """
    dataset의 df['gloss_id'] 형태소별로 분리하여 고유한 형태소(token) 집합 반환.
    """
    morph_tokens = set()
    for gloss in dataset.df["gloss_id"]:
        tokens = gloss.split()
        morph_tokens.update(tokens)
    return list(morph_tokens)

# global_best_config를 이용해 데이터셋 생성
train_dataset = KOSignDataset(train_csv, tokenizer, max_source_length=global_best_config["max_source_length"], max_target_length=global_best_config["max_target_length"])
valid_dataset = KOSignDataset(valid_csv, tokenizer, max_source_length=global_best_config["max_source_length"], max_target_length=global_best_config["max_target_length"])

# train과 validation 데이터셋에서 형태소 추출 및 합집합 생성
train_morph_tokens = set(extract_morph_tokens(train_dataset))
valid_morph_tokens = set(extract_morph_tokens(valid_dataset))
allowed_gloss_tokens = list(train_morph_tokens.union(valid_morph_tokens))

# allowed_gloss_tokens에 포함된 형태소들을 토큰 시퀀스로 변환하여 allowed_sequences 사전 구성
allowed_sequences = {}
for gloss in allowed_gloss_tokens:
    token_ids = tokenizer(gloss, add_special_tokens=False)['input_ids']
    allowed_sequences[gloss] = token_ids

def prefix_allowed_tokens_fn(batch_id, input_ids):
    generated = input_ids.tolist()
    allowed_next_tokens = set()

    for seq in allowed_sequences.values():
        if generated == seq[:len(generated)]:
            if len(generated) == len(seq):
                allowed_next_tokens.add(tokenizer.eos_token_id)
            else:
                allowed_next_tokens.add(seq[len(generated)])
    
    if len(generated) == 0:
        for seq in allowed_sequences.values():
            allowed_next_tokens.add(seq[0])
    
    if not allowed_next_tokens:
        allowed_next_tokens.add(tokenizer.eos_token_id)
    
    return list(allowed_next_tokens)

# 최종 추론
best_model = BartForConditionalGeneration.from_pretrained('hyunwoongko/kobart')
best_model.load_state_dict(global_best_model_state)
best_model.to(device)
best_model.eval()

sample_dataloader = DataLoader(valid_dataset, batch_size=8, shuffle=False)
with torch.no_grad():
    for batch in sample_dataloader:
        input_ids = batch[0]['input_ids'].to(device)
        attention_mask = batch[0]['attention_mask'].to(device)
        outputs = best_model.generate(
            input_ids=input_ids,
            attention_mask=attention_mask,
            prefix_allowed_tokens_fn=prefix_allowed_tokens_fn,
            max_length=global_best_config["max_target_length"],
            num_beams=global_best_config["num_beams"],
            early_stopping=True
        )
        for output in outputs:
            decoded = tokenizer.decode(output, skip_special_tokens=True)
            print(decoded)
```

### 3. 생성한 수어 형태소 데이터를 좌표로 출력

![image](https://github.com/user-attachments/assets/c5c8b694-500f-41e3-8490-7d2c7d2aedcc)


생성된 수어 형태소 데이터로 원본 데이터셋 json 파일에서 형태소 별 좌표 데이터셋을 추출하여 3D 좌표 데이터를 추출합니다. 이후 koBart 모델로 생성된 형태소와 매핑하여 최종 좌표데이터를 생성합니다.

- 형태소-좌표 데이터 추출
    
    ```python
    # 좌표 데이터 추출 코드
    def extract_morpheme_data(json_file_path):
        try:
            with open(json_file_path, 'r', encoding='utf-8') as f:
                data = json.load(f)
            
            # 파일 아이디: metadata에 id가 없으면 파일명 사용
            file_id = os.path.abspath(json_file_path)
            
            result = {
                "file_id": file_id,
                "korean_text": data.get("korean_text", ""),
                "morphemes": []
            }
            
            # sign_script 내에서 제스처 리스트 처리 (예: "sign_gestures_both"만 처리)
            sign_script = data.get("sign_script", {})
            for gesture in sign_script.get("sign_gestures_both", []):
                if "gloss_id" in gesture:
                    # 초(second) 단위를 30fps 기준 프레임으로 변환
                    start_sec = gesture.get("start")
                    end_sec = gesture.get("end")
                    converted_start = int(round(start_sec * 30)) if start_sec is not None else None
                    converted_end = int(round(end_sec * 30)) if end_sec is not None else None
                    
                    # 기본 morpheme_info 구성 (3D 좌표 관련 키는 빈 리스트로 설정)
                    morpheme_info = {
                        "gloss_id": gesture["gloss_id"],
                        "start_frame": converted_start,
                        "end_frame": converted_end,
                        "pose_keypoints_3d": [],
                        "face_keypoints_3d": [],
                        "hand_right_keypoints_3d": [],
                        "hand_left_keypoints_3d": []
                    }
                    
                    # 만약 기존 gesture에 "coordinates" 등이 있다면 필요에 따라 추가 가능
                    if "coordinates" in gesture:
                        morpheme_info["coordinates"] = gesture["coordinates"]
                    
                    result["morphemes"].append(morpheme_info)
            
            return result
        
        except Exception as e:
            print(f"Error processing {json_file_path}: {str(e)}")
            return None
    
    def add_keypoints_data(result_dict):
        json_file_path = result_dict.get("file_id")
        if not json_file_path or not os.path.exists(json_file_path):
            print(f"파일이 존재하지 않습니다: {json_file_path}")
            return result_dict
    
        try:
            with open(json_file_path, 'r', encoding='utf-8') as f:
                data = json.load(f)
        except Exception as e:
            print(f"json 파일 읽기 오류: {e}")
            return result_dict
    
        # landmarks 섹션 추출 (각 키의 값은 3D 좌표 리스트)
        landmarks = data.get("landmarks", {})
        keys_to_extract = ["pose_keypoints_3d", "face_keypoints_3d", "hand_right_keypoints_3d", "hand_left_keypoints_3d"]
    
        # 모든 좌표 데이터가 flat 리스트가 아니면 flatten 처리 (예: 이중 리스트라면 모두 합치기)
        def flatten_list(lst):
            flat = []
            for item in lst:
                if isinstance(item, list):
                    flat.extend(item)
                else:
                    flat.append(item)
            return flat
    
        # 각 key에 대해 flat한 리스트를 준비
        flat_landmarks = {}
        for key in keys_to_extract:
            raw_list = landmarks.get(key, [])
            if raw_list and isinstance(raw_list, list):
                # 만약 첫 항목이 리스트인 경우 모든 서브리스트를 합침
                if raw_list and isinstance(raw_list[0], list):
                    flat_landmarks[key] = flatten_list(raw_list)
                else:
                    flat_landmarks[key] = raw_list
            else:
                flat_landmarks[key] = []
    
        # 각 morpheme에 대해 좌표 데이터 채워넣기
        for morpheme in result_dict.get("morphemes", []):
            start_frame = morpheme.get("start_frame")
            end_frame = morpheme.get("end_frame")
            if start_frame is None or end_frame is None:
                # start/end 값이 없으면 건너뜁니다.
                continue
            # 각 key에 대해 프레임 범위에 맞는 인덱스 계산: 한 프레임은 3개의 숫자
            start_index = start_frame * 3
            end_index = (end_frame + 1) * 3  # end_frame 포함
    
            # 각 key에 대해 추출 후, morpheme 딕셔너리에 대입
            for key in keys_to_extract:
                full_list = flat_landmarks.get(key, [])
                # 추출된 부분이 full_list의 길이를 넘지 않으면 slice
                if full_list and len(full_list) >= end_index:
                    morpheme[key] = full_list[start_index:end_index]
                else:
                    morpheme[key] = []  # 해당 범위의 데이터가 없으면 빈 리스트로 둡니다.
        
        return result_dict
    ```
    

```python
# 형태소-좌표 데이터 추출 샘플
형태소: 오늘1
  pose_keypoints_3d: [69.51983642578125, 290.9852294921875, 2493.46142578125, 69.5283203125, 301.3751220703125, 2493.384521484375, -51.27252197265625, -290.068115234375, 2462.702392578125, 2.7118351459503174, -294.1003112792969, 2468.516357421875, -100.81948852539062, -277.3905944824219, 2513.40771484375, 508.1690979003906, -3764.00341796875, 27106.01953125, 79.64136505126953, 311.6502685546875, 2489.865478515625, 89.7163314819336, 311.5231628417969, 2486.360595703125, 59.40117645263672, 311.8730163574219, 2496.681884765625, -109.2372055053711, 309.769775390625, 2501.256591796875, -119.58827209472656, 309.69952392578125, 2503.476806640625, -88.58204650878906, 309.8785095214844, 2496.61181640625, -23.94500732421875, -266.3810119628906, 2457.890869140625]
  face_keypoints_3d: [-12.704950332641602, -232.4254913330078, 2461.63720703125, -1.5362138748168945, -232.5863037109375, 2468.660400390625, -12.704950332641602, -232.4254913330078, 2461.63720703125, -18.27460479736328, -231.6754150390625, 2460.50830078125, -23.848003387451172, -231.6488800048828, 2460.558349609375, -51.41286849975586, -286.54791259765625, 2465.159423828125, 3.7983717918395996, -289.064208984375, 2477.14453125, -95.25001525878906, -288.1257019042969, 2503.927001953125, -93.58068084716797, -270.2471618652344, 2504.47998046875, -92.69723510742188, -251.9783477783203, 2499.80517578125, -89.65399932861328, -233.0514678955078, 2494.048095703125, -82.83992004394531, -217.1623992919922, 2485.563720703125, -69.2105941772461, -206.16831970214844, 2477.2646484375]
  hand_right_keypoints_3d: [-189.41244506835938, 268.05126953125, 2469.795654296875, -169.0386199951172, 284.2901916503906, 2458.62060546875, -153.95030212402344, 314.3478088378906, 2450.843017578125, -147.5525665283203, 341.7933349609375, 2449.027587890625, -137.5189208984375, 362.90869140625, 2447.486328125, -181.13368225097656, 336.94775390625, 2446.99462890625, -173.9931640625, 368.29638671875, 2451.62890625, -167.67982482910156, 384.55810546875, 2457.3896484375, -163.04220581054688, 398.7231750488281, 2461.3603515625, -195.01441955566406, 340.38623046875, 2458.553955078125, -187.63072204589844, 369.7511901855469, 2461.40283203125, -177.8263397216797, 387.70574951171875, 2469.333984375, -169.69833374023438, 401.7091064453125, 2474.0478515625]
  hand_left_keypoints_3d: [156.63897705078125, 273.18194580078125, 2511.91357421875, 137.501708984375, 290.991455078125, 2494.853515625, 130.15188598632812, 317.96331787109375, 2483.481201171875, 126.7759017944336, 345.4326171875, 2476.98779296875, 123.9388427734375, 367.54302978515625, 2474.097412109375, 163.2546844482422, 337.08502197265625, 2485.725830078125, 155.61105346679688, 367.81317138671875, 2480.73291015625, 144.22171020507812, 384.7026672363281, 2481.42822265625, 133.69630432128906, 396.2939758300781, 2476.95849609375, 170.9071044921875, 341.58282470703125, 2500.16650390625, 159.84942626953125, 371.30889892578125, 2489.099853515625, 145.86904907226562, 388.03118896484375, 2491.371337890625, 134.03761291503906, 401.90606689453125, 2496.34619140625]
---------------------------------
형태소: 밤1
  pose_keypoints_3d: [-27.00404930114746, -108.9870376586914, 2513.258056640625, -155.4560546875, -108.11924743652344, 2519.085693359375, -189.29556274414062, 100.50753784179688, 2509.17138671875, -189.72848510742188, 269.41986083984375, 2465.44384765625, 114.42880249023438, -117.16500854492188, 2550.32666015625, 142.0125732421875, 89.40538024902344, 2521.470703125, 153.9210968017578, 262.75469970703125, 2491.61865234375, -19.694257736206055, 277.7304382324219, 2490.560302734375, -99.19844818115234, 279.6014099121094, 2502.12158203125, -99.16311645507812, 289.9016418457031, 2502.190185546875, -99.12812042236328, 300.205078125, 2502.2578125, 69.51061248779297, 280.5972595214844, 2493.536865234375, 69.51983642578125, 290.9852294921875, 2493.46142578125, 69.5283203125, 301.3751220703125, 2493.384521484375, -51.27252197265625, -290.068115234375, 2462.702392578125, 2.7118351459503174, -294.1003112792969, 2468.516357421875, -100.81948852539062, -277.3905944824219, 2513.40771484375, 508.23834228515625, -3764.0771484375, 27107.30078125]
  face_keypoints_3d: [-52.87037658691406, -200.0062255859375, 2470.74169921875, -35.513946533203125, -196.35520935058594, 2463.787353515625, -18.022537231445312, -195.99542236328125, 2462.68212890625, -1.498656988143921, -200.3538818359375, 2468.195068359375, 11.451793670654297, -209.73712158203125, 2477.043701171875, 23.472230911254883, -221.24172973632812, 2488.818359375, 32.75245666503906, -234.85556030273438, 2500.721923828125, 34.10718536376953, -248.45025634765625, 2493.97509765625, 36.46681594848633, -262.96527099609375, 2492.7783203125, 36.95053482055664, -277.26287841796875, 2496.455322265625, 36.75436019897461, -290.4905700683594, 2499.116943359375, -74.0140151977539, -299.9352722167969, 2468.669189453125, -64.4774398803711, -304.01947021484375, 2468.566162109375, -55.30247116088867, -306.27655029296875, 2465.29248046875, -45.52599334716797, -306.215087890625, 2462.900390625, -34.695919036865234, -303.67340087890625, 2462.65625, -12.372836112976074, -304.14215087890625, 2465.046630859375, -1.9273055791854858, -308.1534423828125, 2471.94482421875]
  hand_right_keypoints_3d: [-202.49801635742188, 336.26043701171875, 2469.732421875, -198.88011169433594, 362.55157470703125, 2470.16796875, -187.27633666992188, 380.76507568359375, 2482.45849609375, -177.88882446289062, 395.5649719238281, 2489.2529296875, -206.30435180664062, 330.864990234375, 2478.22119140625, -202.55084228515625, 355.14837646484375, 2485.995849609375, -193.17344665527344, 366.3129577636719, 2497.031005859375, -189.30392456054688, 373.28863525390625, 2497.530517578125, -189.7949981689453, 268.535400390625, 2468.4130859375, -168.576171875, 285.3294372558594, 2459.15185546875, -153.84011840820312, 315.121337890625, 2451.04541015625, -147.4942626953125, 341.361328125, 2447.8525390625, -137.54159545898438, 363.3395080566406, 2448.76806640625, -181.1194305419922, 337.7337646484375, 2447.43017578125, -174.42373657226562, 367.0972900390625, 2451.37109375, -167.67982482910156, 384.55810546875, 2457.3896484375, -163.04220581054688, 398.7231750488281, 2461.3603515625, -194.52536010742188, 340.23040771484375, 2459.69873046875]
  hand_left_keypoints_3d: [170.33535766601562, 341.86474609375, 2505.109619140625, 162.1282501220703, 367.2787170410156, 2497.7421875, 146.59327697753906, 384.4223327636719, 2497.41357421875, 136.77391052246094, 397.5806884765625, 2502.264892578125, 168.13577270507812, 341.08648681640625, 2516.404541015625, 158.56004333496094, 362.9622802734375, 2503.038330078125, 148.75811767578125, 372.490966796875, 2499.73291015625, 142.7941131591797, 380.208740234375, 2502.4091796875, 156.63897705078125, 273.18194580078125, 2511.91357421875, 137.912841796875, 291.01214599609375, 2495.8916015625, 130.55691528320312, 318.36279296875, 2484.55810546875, 126.7759017944336, 345.4326171875, 2476.98779296875, 124.24044799804688, 367.510498046875, 2474.77978515625, 163.2546844482422, 337.08502197265625, 2485.725830078125, 155.61105346679688, 367.81317138671875, 2480.73291015625, 144.22171020507812, 384.7026672363281, 2481.42822265625, 133.69630432128906, 396.2939758300781, 2476.95849609375, 171.186279296875, 341.777099609375, 2501.09228515625]
---------------------------------
```

출력결과

```python
sample_text = "오늘 한파로 도로결빙이 생겼어요."

번역 결과: 오늘1 춥다1 길1 얼음1
형태소: 오늘1
  pose_keypoints_3d: [69.51983642578125, 290.9852294921875, 2493.46142578125, 69.5283203125, 301.3751220703125, 2493.384521484375, -51.27252197265625, -290.068115234375, 2462.702392578125, 2.7118351459503174, -294.1003112792969, 2468.516357421875, -100.81948852539062, -277.3905944824219, 2513.40771484375, 508.1690979003906, -3764.00341796875, 27106.01953125, 79.64136505126953, 311.6502685546875, 2489.865478515625, 89.7163314819336, 311.5231628417969, 2486.360595703125, 59.40117645263672, 311.8730163574219, 2496.681884765625, -109.2372055053711, 309.769775390625, 2501.256591796875, -119.58827209472656, 309.69952392578125, 2503.476806640625, -88.58204650878906, 309.8785095214844, 2496.61181640625, -23.94500732421875, -266.3810119628906, 2457.890869140625]
  face_keypoints_3d: [-12.704950332641602, -232.4254913330078, 2461.63720703125, -1.5362138748168945, -232.5863037109375, 2468.660400390625, -12.704950332641602, -232.4254913330078, 2461.63720703125, -18.27460479736328, -231.6754150390625, 2460.50830078125, -23.848003387451172, -231.6488800048828, 2460.558349609375, -51.41286849975586, -286.54791259765625, 2465.159423828125, 3.7983717918395996, -289.064208984375, 2477.14453125, -95.25001525878906, -288.1257019042969, 2503.927001953125, -93.58068084716797, -270.2471618652344, 2504.47998046875, -92.69723510742188, -251.9783477783203, 2499.80517578125, -89.65399932861328, -233.0514678955078, 2494.048095703125, -82.83992004394531, -217.1623992919922, 2485.563720703125, -69.2105941772461, -206.16831970214844, 2477.2646484375]
  hand_right_keypoints_3d: [-189.41244506835938, 268.05126953125, 2469.795654296875, -169.0386199951172, 284.2901916503906, 2458.62060546875, -153.95030212402344, 314.3478088378906, 2450.843017578125, -147.5525665283203, 341.7933349609375, 2449.027587890625, -137.5189208984375, 362.90869140625, 2447.486328125, -181.13368225097656, 336.94775390625, 2446.99462890625, -173.9931640625, 368.29638671875, 2451.62890625, -167.67982482910156, 384.55810546875, 2457.3896484375, -163.04220581054688, 398.7231750488281, 2461.3603515625, -195.01441955566406, 340.38623046875, 2458.553955078125, -187.63072204589844, 369.7511901855469, 2461.40283203125, -177.8263397216797, 387.70574951171875, 2469.333984375, -169.69833374023438, 401.7091064453125, 2474.0478515625]
  hand_left_keypoints_3d: [156.63897705078125, 273.18194580078125, 2511.91357421875, 137.501708984375, 290.991455078125, 2494.853515625, 130.15188598632812, 317.96331787109375, 2483.481201171875, 126.7759017944336, 345.4326171875, 2476.98779296875, 123.9388427734375, 367.54302978515625, 2474.097412109375, 163.2546844482422, 337.08502197265625, 2485.725830078125, 155.61105346679688, 367.81317138671875, 2480.73291015625, 144.22171020507812, 384.7026672363281, 2481.42822265625, 133.69630432128906, 396.2939758300781, 2476.95849609375, 170.9071044921875, 341.58282470703125, 2500.16650390625, 159.84942626953125, 371.30889892578125, 2489.099853515625, 145.86904907226562, 388.03118896484375, 2491.371337890625, 134.03761291503906, 401.90606689453125, 2496.34619140625]
---------------------------------
형태소: 춥다1
  pose_keypoints_3d: [-100.81948852539062, -277.3905944824219, 2513.40771484375, 508.1562194824219, -3763.947265625, 27105.927734375, 79.76101684570312, 313.1612854003906, 2490.07421875, 89.83645629882812, 313.03277587890625, 2486.5673828125, 59.51982116699219, 313.3866882324219, 2496.894287109375, -109.26010131835938, 311.203857421875, 2502.8759765625, -119.61774444580078, 311.1340026855469, 2505.095947265625, -88.59173583984375, 311.31170654296875, 2498.231201171875, -23.94500732421875, -266.3810119628906, 2457.890869140625, -27.00404930114746, -108.9870376586914, 2513.258056640625, -155.4560546875, -108.11924743652344, 2519.085693359375, -189.21023559570312, 99.32542419433594, 2509.6494140625, -189.7861785888672, 268.0060729980469, 2465.25390625, 113.1834716796875, -117.95452880859375, 2551.541748046875, 140.11795043945312, 88.22533416748047, 2519.995361328125, 154.037353515625, 262.97027587890625, 2493.187255859375, -18.4241943359375, 278.72808837890625, 2493.334716796875, -98.94742584228516, 278.8975524902344, 2499.733154296875, -98.9107894897461, 289.1885986328125, 2499.80126953125, -98.87449645996094, 299.4827880859375, 2499.86865234375, 69.62881469726562, 282.10565185546875, 2493.74755859375, 69.63836669921875, 292.49493408203125, 2493.672119140625, 69.64716339111328, 302.88616943359375, 2493.59521484375, -51.27252197265625, -290.068115234375, 2462.702392578125, 2.7118351459503174, -294.1003112792969, 2468.516357421875, -100.81948852539062, -277.3905944824219, 2513.40771484375, 508.2165832519531, -3764.087890625, 27106.78125, 79.76101684570312, 313.1612854003906, 2490.07421875, 89.83645629882812, 313.03277587890625, 2486.5673828125]
  face_keypoints_3d: [0.2944258451461792, -284.6003723144531, 2474.814453125, -41.98402786254883, -228.38427734375, 2461.76025390625, -33.59721755981445, -233.0065460205078, 2456.8857421875, -23.91513442993164, -237.1796875, 2460.27783203125, -18.302583694458008, -235.56980895996094, 2460.398681640625, -12.751750946044922, -237.69970703125, 2462.650146484375, -6.4283671379089355, -235.44114685058594, 2462.76171875, 2.650195360183716, -232.67909240722656, 2469.77197265625, -5.982825756072998, -227.37318420410156, 2463.56640625, -12.189403533935547, -223.61300659179688, 2461.535400390625, -18.19660186767578, -222.51513671875, 2459.60888671875, -23.80158042907715, -223.27777099609375, 2461.953125, -33.49015426635742, -225.85540771484375, 2457.3447265625, -38.023193359375, -229.2593994140625, 2460.26953125, -23.848003387451172, -231.6488800048828, 2460.558349609375, -18.27460479736328, -231.6754150390625, 2460.50830078125, -12.704950332641602, -232.4254913330078, 2461.63720703125, -1.5362138748168945, -232.5863037109375, 2468.660400390625, -12.704950332641602, -232.4254913330078, 2461.63720703125, -18.27460479736328, -231.6754150390625, 2460.50830078125, -23.848003387451172, -231.6488800048828, 2460.558349609375, -51.41286849975586, -286.54791259765625, 2465.159423828125, 3.7983717918395996, -289.064208984375, 2477.14453125, -95.25001525878906, -288.1257019042969, 2503.927001953125, -93.58068084716797, -270.2471618652344, 2504.47998046875, -92.67987060546875, -252.13522338867188, 2499.01611328125, -89.65399932861328, -233.0514678955078, 2494.048095703125, -82.83992004394531, -217.1623992919922, 2485.563720703125, -69.08790588378906, -206.2584228515625, 2478.96044921875]
  hand_right_keypoints_3d: [-169.69833374023438, 401.7091064453125, 2474.0478515625, -202.49801635742188, 336.26043701171875, 2469.732421875, -198.61631774902344, 362.82928466796875, 2471.406982421875, -187.27633666992188, 380.76507568359375, 2482.45849609375, -177.69784545898438, 396.22772216796875, 2488.9423828125, -206.10726928710938, 329.4955139160156, 2478.0556640625, -202.55084228515625, 355.14837646484375, 2485.995849609375, -193.17344665527344, 366.3129577636719, 2497.031005859375, -189.2545166015625, 373.4412841796875, 2496.627197265625, -189.7949981689453, 268.535400390625, 2468.4130859375, -168.55831909179688, 285.8238830566406, 2459.803466796875, -153.74539184570312, 315.3193359375, 2450.34326171875, -147.4942626953125, 341.361328125, 2447.8525390625, -137.54159545898438, 363.3395080566406, 2448.76806640625, -180.8271484375, 338.27557373046875, 2449.414306640625, -174.62171936035156, 366.35595703125, 2451.1865234375, -167.53012084960938, 384.6263427734375, 2458.19921875, -163.04220581054688, 398.7231750488281, 2461.3603515625, -194.31277465820312, 340.0142822265625, 2460.40625, -187.67530822753906, 369.85528564453125, 2462.146484375, -177.8263397216797, 387.70574951171875, 2469.333984375, -169.69833374023438, 401.7091064453125, 2474.0478515625, -202.49801635742188, 336.26043701171875, 2469.732421875, -198.61631774902344, 362.82928466796875, 2471.406982421875, -187.27633666992188, 380.76507568359375, 2482.45849609375, -177.69784545898438, 396.22772216796875, 2488.9423828125, -206.31192016601562, 329.2398681640625, 2477.02783203125, -202.55084228515625, 355.14837646484375, 2485.995849609375, -192.8772735595703, 365.943603515625, 2496.455322265625]
  hand_left_keypoints_3d: [133.60177612304688, 401.2869873046875, 2494.85400390625, 171.84103393554688, 342.32000732421875, 2507.059814453125, 162.49497985839844, 367.32550048828125, 2498.59716796875, 146.72637939453125, 383.9141845703125, 2496.788330078125, 136.74794006347656, 397.3352966308594, 2501.27392578125, 170.22628784179688, 340.7334289550781, 2520.10302734375, 159.38360595703125, 362.51690673828125, 2503.149658203125, 149.18020629882812, 371.7022705078125, 2499.547607421875, 142.7941131591797, 380.208740234375, 2502.4091796875, 156.21206665039062, 272.5775146484375, 2510.7666015625, 137.912841796875, 291.01214599609375, 2495.8916015625, 130.3627166748047, 318.37841796875, 2485.396240234375, 126.63668823242188, 345.43792724609375, 2476.76611328125, 124.36521911621094, 367.07000732421875, 2474.5693359375, 163.30767822265625, 337.46551513671875, 2485.50048828125, 155.47677612304688, 367.595458984375, 2479.938232421875, 144.22171020507812, 384.7026672363281, 2481.42822265625, 133.66928100585938, 396.178955078125, 2475.878173828125, 171.186279296875, 341.777099609375, 2501.09228515625, 159.84942626953125, 371.30889892578125, 2489.099853515625, 145.5619354248047, 387.7144775390625, 2489.4697265625, 133.8461456298828, 401.2082214355469, 2494.11669921875, 171.5161895751953, 341.92022705078125, 2506.146484375, 162.49497985839844, 367.32550048828125, 2498.59716796875, 146.72637939453125, 383.9141845703125, 2496.788330078125, 137.0597686767578, 397.43475341796875, 2501.98291015625, 169.77334594726562, 340.1201171875, 2517.60400390625, 158.95095825195312, 362.1258544921875, 2502.486328125, 149.18020629882812, 371.7022705078125, 2499.547607421875]
---------------------------------
형태소: 길1
  pose_keypoints_3d: [-74.28135681152344, -290.4172668457031, 2446.07373046875, -6.400460243225098, -293.65460205078125, 2464.612060546875, -114.57771301269531, -272.86077880859375, 2494.1572265625, 289.9704895019531, -3284.343994140625, 23920.1875, 68.23831176757812, 338.43865966796875, 2506.1513671875, 78.39383697509766, 338.30908203125, 2502.69580078125, 47.839080810546875, 338.66387939453125, 2512.865234375, -130.554443359375, 332.39996337890625, 2506.283203125, -140.9339141845703, 332.309814453125, 2508.3828125, -109.83775329589844, 332.5466003417969, 2501.8779296875, -38.737098693847656, -261.64752197265625, 2444.022705078125, -30.285860061645508, -107.60649108886719, 2525.76318359375, -170.8109130859375, -103.39544677734375, 2502.22216796875, -208.54391479492188, 101.97886657714844, 2529.425537109375, -215.5758056640625, 289.4119567871094, 2511.05810546875, 102.87784576416016, -116.34732055664062, 2536.3515625, 148.019775390625, 88.90742492675781, 2555.572509765625, 146.7804412841797, 280.0710144042969, 2523.495849609375, -29.777219772338867, 302.2693176269531, 2511.23388671875, -120.29815673828125, 301.573974609375, 2503.864013671875, -120.26139831542969, 311.872314453125, 2503.94873046875, -120.22494506835938, 322.1739501953125, 2504.032470703125]
  face_keypoints_3d: [-109.18144226074219, -288.276123046875, 2488.63134765625, -108.45277404785156, -269.623779296875, 2488.72119140625, -106.3427963256836, -252.61976623535156, 2491.37451171875, -102.99597930908203, -234.9288330078125, 2487.488037109375, -96.76448059082031, -218.5196075439453, 2478.171875, -84.61272430419922, -207.11209106445312, 2472.2841796875, -71.44023132324219, -196.86013793945312, 2465.06787109375, -54.7427864074707, -190.89981079101562, 2463.873046875, -37.0921630859375, -189.54698181152344, 2464.138427734375, -22.644712448120117, -192.9981689453125, 2467.44482421875, -7.735653400421143, -202.90695190429688, 2478.2197265625, 4.047031879425049, -213.73455810546875, 2484.81884765625, 11.306181907653809, -228.25143432617188, 2488.281982421875, 16.354753494262695, -242.47412109375, 2486.79638671875, 17.149682998657227, -256.6927795410156, 2479.39306640625, 21.142274856567383, -272.19244384765625, 2481.345947265625, 21.61886215209961, -287.3142395019531, 2485.22216796875, -92.46369934082031, -306.2010498046875, 2457.40625, -83.68008422851562, -311.8482666015625, 2453.985595703125, -72.37351989746094, -312.5901184082031, 2451.923095703125, -60.87358856201172, -311.4333801269531, 2449.779541015625, -51.29846954345703, -305.63543701171875, 2445.7763671875]
  hand_right_keypoints_3d: [-207.80874633789062, 403.1361083984375, 2519.887451171875, -189.57687377929688, 415.7696228027344, 2517.486572265625, -175.75543212890625, 425.62255859375, 2512.427490234375, -219.840576171875, 368.5394287109375, 2522.899169921875, -206.424072265625, 394.5694274902344, 2524.62890625, -197.0651092529297, 404.14306640625, 2522.528076171875, -185.3883056640625, 412.22332763671875, 2526.15185546875, -212.6217803955078, 299.5167541503906, 2518.34033203125, -198.0123291015625, 316.1910400390625, 2506.287109375, -189.7650146484375, 344.90142822265625, 2491.120849609375, -184.21981811523438, 372.69439697265625, 2487.36474609375, -180.97494506835938, 394.67071533203125, 2482.345458984375, -212.20046997070312, 370.6648864746094, 2496.952880859375, -199.4114990234375, 401.88055419921875, 2496.54541015625, -185.04769897460938, 418.31427001953125, 2498.044921875, -173.2855224609375, 430.5670166015625, 2498.17578125, -219.64846801757812, 373.6224060058594, 2503.55322265625, -204.34664916992188, 407.1576843261719, 2507.61181640625, -187.01223754882812, 422.3198547363281, 2507.5283203125, -172.8486785888672, 432.865478515625, 2505.735107421875, -221.0060577392578, 371.90667724609375, 2513.47412109375, -207.80874633789062, 403.1361083984375, 2519.887451171875]
  hand_left_keypoints_3d: [143.81552124023438, 388.4803771972656, 2527.2353515625, 128.37611389160156, 406.55975341796875, 2525.40478515625, 119.72731018066406, 421.17254638671875, 2524.219482421875, 159.13656616210938, 358.60296630859375, 2554.146240234375, 144.1949920654297, 378.4256591796875, 2530.48583984375, 135.17184448242188, 386.05133056640625, 2534.1923828125, 125.40213775634766, 396.6155700683594, 2528.232421875, 145.9466552734375, 284.8789367675781, 2528.07177734375, 127.28466033935547, 302.393798828125, 2510.11962890625, 119.79615783691406, 333.562744140625, 2504.238037109375, 118.76148986816406, 361.760009765625, 2502.66943359375, 114.66127014160156, 385.0785217285156, 2502.87109375, 145.13754272460938, 357.2372131347656, 2508.7841796875, 132.6533203125, 388.37969970703125, 2510.139404296875, 121.6939697265625, 408.85272216796875, 2514.70751953125, 113.45449829101562, 422.7076110839844, 2513.102783203125, 155.50193786621094, 361.66607666015625, 2528.8330078125, 139.1582794189453, 393.4311828613281, 2522.6376953125, 124.51705932617188, 412.79620361328125, 2519.58740234375, 112.69659423828125, 425.079345703125, 2514.365234375, 158.9724884033203, 360.67645263671875, 2537.984130859375, 143.81552124023438, 388.4803771972656, 2527.2353515625]
---------------------------------
형태소: 얼음1
  pose_keypoints_3d: [-114.17974853515625, 316.5238342285156, 2898.23486328125, -114.16629028320312, 328.3951416015625, 2898.46875, -114.1530532836914, 340.2713623046875, 2898.701171875, 97.50674438476562, 317.2593688964844, 2879.353271484375, 97.4979248046875, 329.206787109375, 2879.3759765625, 97.48835754394531, 341.1573181152344, 2879.397216796875, -57.53370666503906, -411.6306457519531, 2772.29736328125, 11.262556076049805, -416.78204345703125, 2790.05517578125, -101.18174743652344, -399.31378173828125, 2865.36083984375, 510.32647705078125, -4017.16455078125, 26280.2265625, 109.13494873046875, 353.0546875, 2875.826171875, 120.75907897949219, 352.98504638671875, 2872.14892578125, 85.7894515991211, 353.1536865234375, 2882.919189453125, -126.09007263183594, 351.9604797363281, 2900.84716796875, -138.0511474609375, 351.7552490234375, 2902.67041015625, -102.20222473144531, 352.3309326171875, 2896.92578125, -26.55931854248047, -385.05755615234375, 2761.28662109375, -11.107799530029297, -193.5313720703125, 2913.74267578125, -170.16226196289062, -189.44403076171875, 2904.751953125, -214.95074462890625, 76.75672912597656, 2952.10302734375, -226.759765625, 310.775634765625, 2909.69677734375, 139.72695922851562, -199.44113159179688, 2888.84765625, 193.8427734375, 64.02202606201172, 2901.40478515625, 208.7408447265625, 293.6467590332031, 2869.36962890625, -7.097668647766113, 313.5906677246094, 2882.213134765625]
  face_keypoints_3d: [3.1104159355163574, -342.52435302734375, 2777.4189453125, -5.727875232696533, -336.53875732421875, 2772.908203125, -15.783623695373535, -332.224609375, 2766.203125, -22.356246948242188, -331.41058349609375, 2766.7802734375, -28.997404098510742, -331.2191162109375, 2768.7353515625, -37.35668182373047, -335.1339111328125, 2778.27685546875, -43.123390197753906, -342.0509033203125, 2782.168701171875, -28.994152069091797, -342.677490234375, 2766.89599609375, -22.366193771362305, -342.36639404296875, 2765.740234375, -16.174583435058594, -343.2120361328125, 2765.340087890625, -2.1537156105041504, -342.8551025390625, 2778.697021484375, -16.25566291809082, -342.6440734863281, 2765.446533203125, -22.41115379333496, -341.73333740234375, 2766.41650390625, -29.463390350341797, -341.7623596191406, 2766.0673828125, -54.27953338623047, -409.5623779296875, 2783.6533203125, 9.595941543579102, -411.2342529296875, 2782.8955078125, -98.16822814941406, -414.9930419921875, 2849.29736328125, -97.7140121459961, -392.56817626953125, 2846.9130859375, -96.50949096679688, -371.722412109375, 2844.90869140625, -90.825927734375, -350.85546875, 2844.242919921875, -83.7683334350586, -332.36029052734375, 2830.202880859375, -70.67031860351562, -317.7272644042969, 2814.494873046875, -56.305946350097656, -307.7685241699219, 2798.01171875, -37.67649459838867, -301.3196716308594, 2790.498291015625, -20.538711547851562, -299.9575500488281, 2777.0498046875]
  hand_right_keypoints_3d: [-181.8910369873047, 440.14288330078125, 2954.25244140625, -174.95909118652344, 454.8653869628906, 2961.29248046875, -225.68170166015625, 320.8131103515625, 2901.1884765625, -208.84751892089844, 339.1117248535156, 2880.1591796875, -185.72857666015625, 371.209228515625, 2872.3798828125, -169.79481506347656, 400.130615234375, 2868.71484375, -162.21070861816406, 422.0299072265625, 2861.512451171875, -195.47879028320312, 406.068115234375, 2892.998046875, -181.32289123535156, 440.7298278808594, 2905.379638671875, -174.86663818359375, 463.2215270996094, 2912.5146484375, -170.58660888671875, 479.5199279785156, 2910.60791015625, -197.7178497314453, 411.29058837890625, 2915.1630859375, -187.33059692382812, 443.1893310546875, 2919.470703125, -178.90151977539062, 468.04034423828125, 2924.40771484375, -171.88580322265625, 484.29876708984375, 2922.50830078125, -203.08102416992188, 405.62005615234375, 2919.108154296875, -191.10546875, 435.04180908203125, 2939.08349609375, -179.69833374023438, 461.3392333984375, 2947.85546875, -174.16180419921875, 483.0609130859375, 2952.591064453125, -202.96255493164062, 401.45556640625, 2932.528076171875, -191.91986083984375, 427.6070556640625, 2957.16064453125, -181.45193481445312, 440.1832275390625, 2955.24267578125, -174.47276306152344, 454.6099548339844, 2962.276123046875, -225.68170166015625, 320.8131103515625, 2901.1884765625, -208.84751892089844, 339.1117248535156, 2880.1591796875]
  hand_left_keypoints_3d: [180.439697265625, 421.2994384765625, 2903.20654296875, 174.04273986816406, 437.3817138671875, 2902.946044921875, 202.7379913330078, 302.40155029296875, 2862.78955078125, 176.8956756591797, 325.19097900390625, 2839.404296875, 155.32464599609375, 360.1143493652344, 2828.6435546875, 142.38470458984375, 389.239990234375, 2831.0693359375, 133.546630859375, 413.1307373046875, 2829.325439453125, 177.08065795898438, 390.169921875, 2849.48974609375, 169.7500762939453, 425.65142822265625, 2867.6708984375, 161.94212341308594, 449.50323486328125, 2872.23583984375, 156.51852416992188, 467.13916015625, 2876.3984375, 187.08706665039062, 391.49737548828125, 2869.00146484375, 177.4524688720703, 428.66131591796875, 2879.975830078125, 167.93682861328125, 451.8923034667969, 2881.021728515625, 162.6163330078125, 469.49066162109375, 2888.96630859375, 195.12832641601562, 390.64801025390625, 2882.82666015625, 185.975341796875, 421.30938720703125, 2892.9287109375, 173.19833374023438, 444.411376953125, 2893.15087890625, 171.87203979492188, 463.7621765136719, 2904.946044921875, 198.7446746826172, 384.71136474609375, 2903.81640625, 188.14218139648438, 408.7785339355469, 2893.362060546875, 180.439697265625, 421.2994384765625, 2903.20654296875, 174.4180145263672, 437.10736083984375, 2903.80810546875, 202.7379913330078, 302.40155029296875, 2862.78955078125, 176.8956756591797, 325.19097900390625, 2839.404296875]
---------------------------------
```

애니메이션 생성

### 4. 좌표 데이터를 아바타 애니메이션으로 생성

처음 계획은 추출된 좌표 데이터를 유니티에 입력하여 리깅 모델을 애니메이팅 하는것이였습니다. 하지만 계속 아래와 같이 모델이 깨지는 현상이 발생했습니다. 다른 팀원이 유니티 개발 경험이 있어 유니티로 진행했었지만 해당 에러의 원인을 몰라 헤매고있었습니다.


https://github.com/user-attachments/assets/86ab2747-0084-4304-b09c-63b86d22f308


이후 koBart 모델학습이 끝나고 함께 에러를 찾아보고자 저는 블렌더로 좌표 데이터를 매핑하던 중, 다운로드 받은 리깅모델의 Armature와 좌표 데이터에 해당하는 Armature의 본 개수가 다르다는것을 확인하고 이것이 문제의 원인임을 알게 되었습니다.

이후 블렌더와 유니티 두가지 프로그램으로 에러를 해결해보고자 각각 트러블슈팅을 진행하였고, 우선 블렌더에서 파이썬 스크립팅을 활용하여 좌표 데이터를 애니메이팅 하였습니다.

- 블랜더 스크립트
    
    ```python
    import bpy
    import json
    
    # JSON 파일 경로를 지정하세요.
    json_filepath = '/Users/kwonsejin/Desktop/side_project/NIA_SL_G1_COLDWAVE000010_1_TW07.json'
    
    with open(json_filepath, 'r') as f:
        data = json.load(f)
    
    # landmarks 객체에서 얼굴, 포즈, 왼손, 오른손 3D 좌표 데이터를 가져옵니다.
    landmarks = data['landmarks']
    face_data = landmarks['face_keypoints_3d']
    pose_data = landmarks['pose_keypoints_3d']
    hand_left_data = landmarks['hand_left_keypoints_3d']
    hand_right_data = landmarks['hand_right_keypoints_3d']
    
    # 평면의 리스트를 3D 좌표의 리스트로 그룹화하는 함수입니다.
    def group_points(flat_list):
        return [flat_list[i:i+3] for i in range(0, len(flat_list), 3)]
    
    # 각 landmark 데이터는 프레임별로 저장된 배열입니다.
    # 모든 landmark 데이터의 프레임 수가 동일하다고 가정합니다.
    num_frames = len(face_data)
    
    # Blender 씬의 프레임 범위를 데이터에 맞게 설정 (예: 700 프레임)
    bpy.context.scene.frame_start = 1
    bpy.context.scene.frame_end = num_frames
    
    # 지정한 프레임 번호의 데이터를 모두 결합해서 하나의 좌표 리스트로 만듭니다.
    # 순서는 얼굴, 포즈, 왼손, 오른손 순입니다.
    def get_frame_points(frame_index):
        frame_points = []
        for keypoints in [face_data, pose_data, hand_left_data, hand_right_data]:
            frame = keypoints[frame_index]
            pts = group_points(frame)
            frame_points.extend(pts)
        return frame_points
    
    # 초기 프레임(프레임 0)의 좌표를 사용해서 구체(점)들을 생성합니다.
    initial_points = get_frame_points(0)
    objects = []  # 생성한 객체들을 저장할 리스트
    
    for point in initial_points:
        x, y, z = point
        # 좌표 변환: (x, y, z) -> (x, -z, -y)
        new_point = (x, -z, -y)
        bpy.ops.mesh.primitive_uv_sphere_add(radius=10, location=new_point)
        obj = bpy.context.object
        objects.append(obj)
    
    # 각 프레임마다 객체의 위치를 업데이트하고 키프레임을 삽입하여 애니메이션을 생성합니다.
    for frame_idx in range(num_frames):
        bpy.context.scene.frame_set(frame_idx + 1)  # Blender 프레임은 보통 1부터 시작
        frame_points = get_frame_points(frame_idx)
        for i, point in enumerate(frame_points):
            x, y, z = point
            new_point = (x, -z, -y)  # 좌표 변환
            obj = objects[i]
            obj.location = new_point
            obj.keyframe_insert(data_path="location", frame=frame_idx + 1)
    ```
    



https://github.com/user-attachments/assets/e3969201-c177-4bb1-b563-caa578c259c7


이후 각 좌표의 움직임에 맞춰 Armature를 제작하였습니다.


https://github.com/user-attachments/assets/b0e7a89b-9af5-4caf-b7d8-2fc3e2257849


유니티로 구현한 캐릭터 애니메이션


https://github.com/user-attachments/assets/38f2bdab-db2d-4bc1-9734-0d4a1b8b495e


### 프로젝트 결과

한국어 → 한글수어 형태소 번역모델을 만들때, Bart 등 소형모델로 불가능하면 어쩌나 하는 걱정이 있었지만 EDA에 시간을 할애해 좋은 데이터셋으로 학습을 시키니 좋은성능으로 학습이 되어서 다행이라는 생각이 듭니다. 만약 불가능했다면 컴퓨팅 자원의 한계로 LLM을 학습시키기 어려웠을 것 같습니다.

이후 생각지 못한 3D모델링에서 막혀 어려웠던 프로젝트였습니다. 블렌더 프로그램을 처음 활용하는 탓에 헤매기도 했으나 애니메이션 제작은 나름 흥미로웠습니다. 추후 시간이 난다면 리깅모델에 매쉬도 입혀 완전한 3D 캐릭터를 제작할 예정입니다.
